<!DOCTYPE html>
<html>
<head>

	<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
	<link rel="stylesheet" href="themes/trucktheme.min.css" />
	<link rel="stylesheet" href="themes/jquery.mobile.icons.min.css" />
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile.structure-1.4.5.min.css" />
	<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
 
<title>Vehicle App</title>
</head>
    
<body onload="loadDetails()">
<script type="text/javascript">

		function loadDetails(){
			var driveid=sessionStorage.getItem("check");
			var webserUrl = "http://vinmove.com/epod/abcmove.asmx";
            var soapRequest ='<?xml version="1.0" encoding="utf-8"?> \
			<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" \
			xmlns:xsd="http://www.w3.org/2001/XMLSchema" \
			xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"> \
			<soap:Body> \
			<GetLoadDetails xmlns="http://www.Move.com/">\
 			<pDriverID>'+ driveid + '</pDriverID>\
     		</GetLoadDetails>\
			</soap:Body> \
			</soap:Envelope>';
             			$.ajax({
                    			type: "POST",
                    			url: webserUrl,
                    			contentType: "text/xml",
                    			dataType: "xml",
                    			data: soapRequest,
                    			success: SuccessOccur,
                    			error: ErrorOccur
		    		});

		}
		function SuccessOccur(data, status, req) {
			try{
				var loadID;
				var ClientName;
           			if (status == "success"){
					$(req.responseXML).find('Table').each(function(){
					loadID = $(this).find('LoadsID').text();
					ClientName = $(this).find('Column1').text();
					$("#list").empty(); 
					$("#list").append("<li data-role='collapsible'><H1>" + loadID + "</H1><p>" + ClientName + "</p></li>");     
					$("#list").trigger("create");
					$("#list").listview("refresh");
          									});
							}

			}
			catch(e)
			{
			alert(e.message);
			}
        	}
        function ErrorOccur(data, status, req) {
            alert(req.responseText + " " + status);
        }

</script>
	
<div data-role="page">
<div data-role="header">
<h1>Loads</h1></div>
<div data-role="content" id="content">
<ul id="list" data-role="listview" data-inset="true">
</ul>
</div>
</div>

</body>
</html>
